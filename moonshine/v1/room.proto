syntax = "proto3";

package moonshine.v1;

import "buf/validate/validate.proto";

// RoomService manages LiveKit voice/video rooms.
service RoomService {
  // CreateRoom creates a new room and returns a token to join it.
  rpc CreateRoom(CreateRoomRequest) returns (CreateRoomResponse) {}
  // JoinRoom returns an access token to join an existing room.
  rpc JoinRoom(JoinRoomRequest) returns (JoinRoomResponse) {}
}

message CreateRoomRequest {
  // Human-readable room name.
  string name = 1 [(buf.validate.field).string = {min_len: 1, max_len: 128}];
  // Max participants allowed (0 = unlimited).
  uint32 max_participants = 2;
}

message CreateRoomResponse {
  // The room name as confirmed by the server.
  string room_name = 1;
  // Access token for the creator to join the room.
  string token = 2;
  // LiveKit server URL the client should connect to.
  string url = 3;
}

message JoinRoomRequest {
  // Name of the room to join.
  string room_name = 1 [(buf.validate.field).string = {min_len: 1, max_len: 128}];
}

message JoinRoomResponse {
  // Access token for the participant to join the room.
  string token = 1;
  // LiveKit server URL the client should connect to.
  string url = 2;
}
